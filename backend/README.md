# rivalslfg.com (backend)

![visitors](https://img.shields.io/endpoint?url=https://vu-mi.com/api/v1/views?id=jcserv/rivalslfg.com/backend)

this folder contains the backend for [rivalslfg](https://rivalslfg.vercel.app/), which is deployed to [fly.io](https://fly.io).

*Generated from [go-api-template](https://github.com/jcserv/go-api-template)*

## installation

### prerequisites/stack
- [go](https://go.dev/doc/install)
- [docker](https://docs.docker.com/get-started/get-docker/)
- [sqlc](https://docs.sqlc.dev/en/stable/overview/install.html)
- [golang-migrate CLI](https://github.com/golang-migrate/migrate/tree/master/cmd/migrate)
- OPTIONAL:
  - [postgres](https://www.postgresql.org/)
  - [flyctl](https://fly.io/docs/flyctl/installing/)

### running locally

1. clone the repo
2. `cp .env.example .env`, fill in the required environment variables
3. run `make dev-db`
4. run `make migrate`
5. run `make dev`

### warnings

- sqlc is pretty cool, but it doesn't support all of our required usecases. so, after running `make codegen`, you'll need to manually edit the generated files to remove the autogenerated structs that are already defined in [this file](./internal/repository/models.custom.go).

## todo

1. [X]List Groups
   - [ ] Filter by:
     -  Region
     -  Gamemode
     -  Requirements Met (provided player info)
     -  Visibility
     -  Platform
     -  Gamemode
     -  Size
     -  Group Settings
       - Platforms
       - Voice Chat
       - Mic
2. [ ] Upsert Group
3. [ ] Join Group (if private, authenticate provided passcode)
4. [ ] Remove Player from Group

5. [X] Upsert Player
6. [X] Get Player
7. Authenticate as Player

8.  Chat
9.  Matchmaking
   - Probably requires atomic locks

Bugs:
- No auth right now, so users can modify other users' info if they know their id

Before release:
- [ ] Squash migrations into one, remove seed data